CREATE DEFINER=`root`@`localhost` PROCEDURE `top_n_product`(fy int, country text, top_n int)
BEGIN
SELECT product, round(SUM(net_sales)/1000000,2) as total_net_sales
FROM net_sales_table
WHERE fiscal_year = fy and market = country
GROUP BY product
order by total_net_sales desc limit top_n;
END
