CREATE DEFINER=`root`@`localhost` PROCEDURE `top_n_customers`(fy int, top_n int)
BEGIN
SELECT customer, round(SUM(net_sales)/1000000,2) as total_net_sales
FROM net_sales_table
WHERE fiscal_year = fy
GROUP BY customer
order by total_net_sales desc limit top_n;
END
